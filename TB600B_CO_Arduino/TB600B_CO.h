#ifndef TB600B_H
#define TB600B_H

#include <Arduino.h>

// Command Definitions
const byte ACTIVE_MODE[] = {0xFF, 0x01, 0x78, 0x40, 0x00, 0x00, 0x00, 0x00, 0x47};
const byte PASSIVE_MODE[] = {0xFF, 0x01, 0x78, 0x41, 0x00, 0x00, 0x00, 0x00, 0x46};
const byte READ_GAS[] = {0xFF, 0x01, 0x86, 0x00, 0x00, 0x00, 0x00, 0x00, 0x79};
const byte READ_ALL[] = {0xFF, 0x01, 0x87, 0x00, 0x00, 0x00, 0x00, 0x00, 0x78};
const byte LIGHT_OFF[] = {0xFF, 0x01, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00, 0x77};
const byte LIGHT_ON[] = {0xFF, 0x01, 0x89, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76};

class TB600B {
public:
    TB600B(HardwareSerial& serial);
    void begin(uint32_t baudRate);
    void changeMode();
    void ledOn();
    void ledOff();
    int readGas();
    void readAll(int& gasUgm3, int& gasPpb, float& temperature, float& humidity);

private:
    HardwareSerial& _serial;
    bool _qnaMode = true;
    void sendCommand(const byte* command, byte* response, size_t length);
};

#endif
